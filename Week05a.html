<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Visualizing univariate distributions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="libs\style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Manipulation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 02</li>
    <li>
      <a href="Week02a.html">Data types</a>
    </li>
    <li>
      <a href="Week02b.html">Reading and writing data files</a>
    </li>
    <li>
      <a href="Week02c.html">Working with date objects</a>
    </li>
    <li>
      <a href="Week02d.html">Exploring and cleaning dataframes using base functions</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 03</li>
    <li>
      <a href="Week03a.html">Manipulating dataframes with dplyr</a>
    </li>
    <li>
      <a href="Week03d.html">Working with string objects</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 04</li>
    <li>
      <a href="Week03ab_groupby.html">Grouping and summarizing tables</a>
    </li>
    <li>
      <a href="Week03b.html">Tidying/reshaping tables using tidyr</a>
    </li>
    <li>
      <a href="Week03c.html">Joining data tables</a>
    </li>
    <li>
      <a href="Week03ab_examples.html">Example of data manipulation workflows</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 05</li>
    <li>
      <a href="Week04a.html">The base plotting environment</a>
    </li>
    <li>
      <a href="Week04b.html">The lattice plotting environment</a>
    </li>
    <li>
      <a href="Week04c.html">The ggplot plotting environment</a>
    </li>
    <li>
      <a href="Week04d.html">Manipulating colors in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Univariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 06</li>
    <li>
      <a href="Week05a.html">Visualizing univariate data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 07</li>
    <li>
      <a href="Week05b.html">Comparing univariate data distributions</a>
    </li>
    <li>
      <a href="Week06a.html">Theoretical Q-Q plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 08</li>
    <li>
      <a href="Week07a.html">Fits and residuals</a>
    </li>
    <li>
      <a href="Week07b.html">Spread-location plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 09</li>
    <li>
      <a href="Week08a.html">Re-expressing data</a>
    </li>
    <li>
      <a href="Week08b.html">Letter value summaries</a>
    </li>
    <li>
      <a href="Week08c.html">The Two R’s of EDA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bivariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 10</li>
    <li>
      <a href="Week09a.html">Bivariate analysis</a>
    </li>
    <li>
      <a href="Week09b.html">Resistant lines</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 11</li>
    <li>
      <a href="Week10a.html">The third R of EDA: Residuals</a>
    </li>
    <li>
      <a href="Week10b.html">Detecting discontinuities in the data</a>
    </li>
    <li>
      <a href="http://mgimond.github.io/Stats-in-R/regression.html">Details of the OLS regression method (optional reading)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Two-way tables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 12</li>
    <li>
      <a href="Week11a.html">Median polish/Mean polish</a>
    </li>
    <li>
      <a href="http://mgimond.github.io/Stats-in-R/ANOVA.html">Details of an ANOVA (optional reading)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Misc01.html">R markdown documents</a>
    </li>
    <li class="dropdown-header">Week 13</li>
    <li>
      <a href="Week12a.html">Creating maps in R</a>
    </li>
    <li class="dropdown-header">Connecting to relational databases</li>
  </ul>
</li>
<li>
  <a href="Data.html">Datasets</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans%7CSource+Code+Pro" rel="stylesheet">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Visualizing univariate distributions</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#histograms">Histograms</a></li>
<li><a href="#boxplots">Boxplots</a><ul>
<li><a href="#not-all-boxplots-are-created-equal">Not all boxplots are created equal!</a></li>
</ul></li>
<li><a href="#quantile-plots">Quantile plots</a><ul>
<li><a href="#computing-the-f-quantile">Computing the <span class="math inline">\(f\)</span>-quantile</a></li>
<li><a href="#creating-a-quantile-plot">Creating a quantile plot</a></li>
</ul></li>
</ul>
</div>

<div style="color:#ff7535; background-color:#fff0ee ;   border-left-style: solid">
<p>This tutorial makes use of the following R package(s): <strong><code>dplyr</code></strong>, <strong><code>tidyr</code></strong>, <strong><code>ggplot2</code></strong>.</p>
<p>This material can be read in conjunction with <strong>sections 2.1 and 2.3</strong> of <strong>Cleveland’s book</strong><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Let’s create two batches of numbers, <code>a</code> and <code>b</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">12</span>, <span class="dv">10</span>)
b  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">15</span>, <span class="dv">10</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(a,b)</code></pre></div>
<p>How do the two batches differ?</p>
<table style="width:14%;">
<colgroup>
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">a</th>
<th align="left">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">15</td>
</tr>
</tbody>
</table>
<p>If the difference wasn’t obvious from the table view we can create a jittered point plot from the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># To plot across categories, we need the data in a long (tidy) form</span>
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(ggplot2)

dfl &lt;-<span class="st"> </span><span class="kw">gather</span>(df, <span class="dt">key=</span>Category, <span class="dt">value=</span>Value)
<span class="kw">ggplot</span>(dfl,  <span class="kw">aes</span>(<span class="dt">y =</span> Value, <span class="dt">x =</span> Category, <span class="dt">col=</span>Category)) <span class="op">+</span><span class="st"> </span>
<span class="st">             </span><span class="kw">geom_jitter</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width=</span><span class="fl">0.4</span>))</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-4-1.png" width="384" /></p>
<p>It’s clear that both batches differ by their uniform values, batch <code>a</code> is made up of the identical numbers, <code>12</code>, and batch <code>b</code> is made up of a different set of identical values, <code>15</code>. Note that because so many values overlapped, we made use of the <code>geom_jitter()</code> function which randomly <em>jitters</em> the data about their actual location.</p>
<p>Now let’s compare a more complicated batch of numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Randomly pick 10 values from a uniform distribution</span>
<span class="kw">set.seed</span>(<span class="dv">23</span>)
a   &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">15</span>))
b   &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>))
<span class="co"># Create wide and long data frames</span>
df  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(a,b)
dfl &lt;-<span class="st"> </span><span class="kw">gather</span>(df, <span class="dt">key=</span>Category, <span class="dt">value=</span>Value)</code></pre></div>
<table style="width:14%;">
<colgroup>
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">a</th>
<th align="left">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">11</td>
<td align="left">19</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">17</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">14</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">13</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">18</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">11</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">16</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">19</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">16</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dfl, <span class="kw">aes</span>(<span class="dt">y =</span> Value, <span class="dt">x =</span> Category, <span class="dt">col=</span>Category)) <span class="op">+</span><span class="st"> </span>
<span class="st">            </span><span class="kw">geom_jitter</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width=</span><span class="fl">0.4</span>))</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-7-1.png" width="384" /></p>
<p>So how do these batches differ? They seem to differ by their center value. For example, each batch’s mean is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
dfl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Value) )</code></pre></div>
<pre><code># A tibble: 2 x 2
  Category  mean
  &lt;chr&gt;    &lt;dbl&gt;
1 a         11.8
2 b         15.8</code></pre>
<p>The center value (aka <strong>location</strong>), is one summary statistic we can use to compare batches. Another property of a batch that we might also want to compare is its distribution (aka <strong>spread</strong>). For example, does the <strong>spread</strong> between the two batches differ as well? It’s difficult to tell from the above plot given that the batches are offset, so we’ll <strong>level</strong> the batches by subtracting the means from their respective batches.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Subtract the batch mean from each batch value</span>
dfl2 &lt;-<span class="st"> </span>dfl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Spread =</span> Value <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Value))

<span class="co"># Now plot the leveled batches</span>
<span class="kw">ggplot</span>(dfl2, <span class="kw">aes</span>(<span class="dt">y =</span> Spread, <span class="dt">x =</span> Category, <span class="dt">col=</span>Category)) <span class="op">+</span><span class="st"> </span>
<span class="st">             </span><span class="kw">geom_jitter</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width=</span><span class="fl">0.4</span>))</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-9-1.png" width="384" /></p>
<p>Removing the <em>location</em> (or mean in our example) from each value facilitates our comparison of both spreads. From our working example we can, at best, say that the batches share the same range. But a spread can be characterized in many more ways than by its range. Next, we’ll focus on three exploratory tools that will help us explore and quantify a dataset’s spread. These are the <strong>histogram</strong>, the <strong>boxplot</strong> and the <strong>quantile plot</strong>.</p>
</div>
<div id="histograms" class="section level1">
<h1>Histograms</h1>
<p>A histogram <strong>bins</strong> the values (usually in equal sized bins) and plots the frequency in which each <em>bin</em> is filled. For example, to create a histogram of batch <code>a</code> where each bin size covers <strong>one</strong> unit, we type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>a)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">6.5</span>,<span class="fl">16.5</span>,<span class="dt">by=</span><span class="dv">1</span>), <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-10-1.png" width="432" /></p>
<p>Here, we are explicitly defining the bin width as 1 unit and the range as 6.5 to 16.5 via the parameter <code>breaks = seq(6.5,16.5,by=1)</code>. The <code>colour</code> parameter specifies the <em>outline</em> color. To change the fill color use the <code>fill</code> parameter instead. In our example, we have one value that falls in the first bin (bin ranging from 6.5 to 7.5), another value that falls in the second bin (bin value ranging from 7.5 to 8.5) and so on up to the second to last bin which has 3 values falling in it (bin covering the range 14.5 to 15.5). No values fall in the 15.5 to 16.5 bin range.</p>
<p>We can modify the width of each bin. For example, to have each bin cover two units instead of one, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>a)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">6.5</span>,<span class="fl">16.5</span>,<span class="dt">by=</span><span class="dv">2</span>), <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-11-1.png" width="432" /></p>
<p>You’ll note that changing bin widths can alter the look of the histogram, this is particularly true when plotting large batches of values.</p>
<p>You can also opt to have the function determine the bin ranges by simply specifying the number of bins using the <code>bin=</code> parameter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>a)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">12</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-12-1.png" width="432" /></p>
</div>
<div id="boxplots" class="section level1">
<h1>Boxplots</h1>
<p>A boxplot is another popular plot used to explore distributions. In <code>ggplot2</code> we use the <code>geom_boxplot()</code> function as in,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span>, <span class="dt">y=</span>a)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">           </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.y=</span><span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">           </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-13-1.png" width="624" /></p>
<p>Note that the <code>coord_flip()</code> function flips the boxplot on its side (the boxplot is normally plotted upright). The <code>geom_boxplot</code> function requires that both x and y axes be mapped a variable; usually, the x-axis is assigned a category, but since we are looking at a unique batch, we artificially map a value of 1 to the x-axis (we could have used any value). This requires that we mask the x-axis’s label and text so as not to confuse the reader using the options <code>xlab(NULL) + theme(axis.text.y=element_blank())</code>.</p>
<p>The following figure describes the anatomy of a boxplot.</p>
<div class="figure">
<img src="img/Boxplot.png" />

</div>
<p>The boxplot provides us with many meaningful pieces of information. For example, it gives us a center value: the median. It also tells us where the middle 50% of the values lie along the full range of values (in our example, approximately 50% of the values lie between 9.5 and 14.5). This range is referred to as the <strong>interquartile</strong> range (or <strong>IQR</strong> for short). Note that this is only an approximation given that some datasets may not lend themselves well to defining exactly 50% of their central values. For example, our batch only has four data points falling within the interquartile range because of tied values.</p>
<p>The long narrow lines extending beyond the interquartile range are sometimes referred to as <strong>whiskers</strong> and are either 1.5 times the width between the median and the nearest interquartile value <em>or</em> the most extreme value, whichever comes first.</p>
<p>Sometimes, you will encounter values that fall outside of the lower and/or upper adjacent values (aka whiskers); such values are often labeled as <strong>outliers</strong>.</p>
<div id="not-all-boxplots-are-created-equal" class="section level2">
<h2>Not all boxplots are created equal!</h2>
<p>Not all boxplots are created equal. There are many different ways in which quantiles can be defined. For example, some will compute a quantile as <span class="math inline">\(( i - 0.5) / n\)</span> where <span class="math inline">\(i\)</span> is the n<sup>th</sup> element of the batch of data and <span class="math inline">\(n\)</span> is the total number of elements in that batch. This is the method implemented by Bill Cleveland and we will refer to this method as <em>Cleveland’s quantile method</em>. This also happens to be the method implemented by the base’s <code>boxplot</code> function which explains the different boxplot output in our working example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(a, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-14-1.png" width="624" /></p>
<p>The upper and lower quartiles differ from those of <code>ggplot</code> since the three <code>15</code> values (these are the maximum values in batch <code>a</code>) end up falling inside the interquartile range following the aforementioned quantile definition. This eliminates any upper whiskers. In most cases, however, the difference will not matter as long as you <em>adopt the same boxplot procedure when comparing batches</em>.</p>
</div>
</div>
<div id="quantile-plots" class="section level1">
<h1>Quantile plots</h1>
<p>A quantile plot generates a point plot that joins the quantile to each value in a batch. The boxplot is a special case of the <span class="math inline">\(f\)</span>-quantile function in that it only returns the 1<sup>st</sup>, 2<sup>nd</sup> (median) and 3<sup>rd</sup> quartiles. The <span class="math inline">\(f\)</span>-quantile returns the <span class="math inline">\(full\)</span> range of quantile values. The quantile is directly related to the concept of a percentile: it identifies the fraction of the batch of numbers that is less than a value of interest. The following figure describes the anatomy of a quantile plot.</p>
<div class="figure">
<img src="img/Quantile.png" />

</div>
<p>The x-axis shows the <span class="math inline">\(f\)</span>-values: the full range of fractions. The y-axis is the <span class="math inline">\(f\)</span>-quantile, <span class="math inline">\(q(f)\)</span>, which shows the sorted batch values (from smallest to largest). The points in the plot link the values on the y-axis to the <span class="math inline">\(f\)</span>-values on the x-axis. For example, the <span class="math inline">\(f\)</span>-value of 0.25 (~the 25<sup>th</sup> percentile) is associated with the <span class="math inline">\(q(f)\)</span> value of 8 meaning that 25% of the values in the dataset have values of 9 or less. Likewise, the <span class="math inline">\(f\)</span>-value of 0.5 (the median) is associated with a <span class="math inline">\(q(f)\)</span> value of 12.5 implying that half of the dataset’s values are 12.5 or less. The boxplot is shown alongside the quantile plot to highlight the analogy.</p>
<div id="computing-the-f-quantile" class="section level2">
<h2>Computing the <span class="math inline">\(f\)</span>-quantile</h2>
<p>Computing <span class="math inline">\(f\)</span> requires that the batch of numbers be ordered from smallest to largest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a.o &lt;-<span class="st"> </span><span class="kw">sort</span>(a)
a.o</code></pre></div>
<pre><code> [1]  7  8  9 11 12 13 13 15 15 15</code></pre>
<p>The concept of sorting values may seem benign, but it is fundamental to many EDA procedures that require robust techniques.</p>
<p>With the numbers sorted, we can proceed with the computation of <span class="math inline">\(f\)</span> following <em>Cleveland’s</em> method:</p>
<p><span class="math display">\[
f_i = \frac{i - 0.5}{n} 
\]</span></p>
<p>where <span class="math inline">\(i\)</span> is the n<sup>th</sup> element of the batch of data and <span class="math inline">\(n\)</span> is the total number of elements in that batch. As noted in the Boxplots section, there are many ways one can compute a quantile, however, the differences may not matter much.</p>
<p>For each value in <code>a</code>, the <span class="math inline">\(f\)</span> value is thus:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i     &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="kw">length</span>(a)
f.val &lt;-<span class="st"> </span>(i <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(a)  <span class="co"># Compute the f-value</span>
a.fi  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(a.o , f.val)</code></pre></div>
<p>Note that in the last line of code, we are appending the ordered representation of <code>a</code> to <code>f.val</code> given that <code>f.val</code> assumes an ordered dataset. The data frame <code>a.fi</code> should look like this:</p>
<table style="width:18%;">
<colgroup>
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">a.o</th>
<th align="left">f.val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">7</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">0.15</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">0.35</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">0.45</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">0.55</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">0.65</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">0.75</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">0.85</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">0.95</td>
</tr>
</tbody>
</table>
<p>It may be desirable at times to find a value associated with a quantile that might not necessarily match an exact value in our batch. For example, there is no value in <code>a</code> associated with a quantile of <span class="math inline">\(0.5\)</span>; this is because we have an even number of values in our dataset. The solution is to interpolate (or extrapolate) a value based on a desired quantile. The <code>quantile()</code> function does just that. For example, to find the value associated with a quantile of <span class="math inline">\(0.5\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>( a, <span class="fl">0.5</span>)</code></pre></div>
<pre><code> 50% 
12.5 </code></pre>
<p>If we want to get quantile values for a range of fractions, simply wrap the values with the <code>c()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>( a, <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))</code></pre></div>
<pre><code> 25%  50%  75% 
 9.5 12.5 14.5 </code></pre>
<p>The <code>quantile</code> function is designed to accept different quantile algorithms. To see the list of algorithm options, type <code>?quantile</code> at a command prompt. By default, R adopts algorithm <code>type = 7</code>. To adopt Cleveland’s algorithm, set <code>type = 5</code>. E.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>( a, <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="dt">type =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code> 25%  50%  75% 
 9.0 12.5 15.0 </code></pre>
<p>Note the difference in the upper quartile value.</p>
</div>
<div id="creating-a-quantile-plot" class="section level2">
<h2>Creating a quantile plot</h2>
<p>A batch’s quantile is best viewed as a plot where we plot the batch values as a function of the <span class="math inline">\(f\)</span>-values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(a.fi, <span class="kw">aes</span>(<span class="dt">x=</span>f.val, <span class="dt">y=</span>a.o)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;f-value&quot;</span>)</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-21-1.png" width="288" /></p>
<p>If you did not want to go through the trouble of computing the <span class="math inline">\(f\)</span>-values and the dataframe <code>a.fi</code>, you could simply call the function <code>stat_qq()</code> as in:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">sample=</span>a)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>(<span class="dt">distribution =</span> qunif) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;f-value&quot;</span>)</code></pre></div>
<p><img src="Week05a_files/figure-html/unnamed-chunk-22-1.png" width="288" /></p>
<p>Note the slight change in mapping values to the <code>aes()</code> function: <code>sample = a</code> where <code>a</code> is the (unsorted) variable being plotted.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Cleveland, William S. <em>Visualizing Data</em>. 1993. Hobart Press.<a href="#fnref1">↩</a></p></li>
</ol>
</div>


<div class="footer">
<hr/>
<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>  Manny Gimond (2018)
</br>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
